{% extends 'base.html' %}
{% block content %}
<h2>Manage Orders</h2>
<table class="table">
  <tr><th>ID</th><th>Customer</th><th>Total</th><th>Status</th><th>Est. Delivery</th><th>Order ID (Razorpay)</th><th>Created</th><th>Action</th></tr>
  {% for o in orders %}
  <tr>
    <td>#{{ o.id }}</td>
    <td>{{ o.customer_name }}<br><small>{{ o.email }}</small></td>
    <td>â‚¹{{ '%.2f'|format(o.total_amount) }}</td>
    <td>{{ o.payment_status }}</td>
    <td>{{ o.estimated_delivery_date or '-' }}</td>
    <td>{{ o.razorpay_order_id or '-' }}</td>
    <td>{{ o.created_at }}</td>
    <td>
      <form method="post" action="{{ url_for('admin_order_status', oid=o.id) }}">
        <select name="status">
          <option value="pending" {% if o.payment_status=='pending' %}selected{% endif %}>pending</option>
          <option value="paid" {% if o.payment_status=='paid' %}selected{% endif %}>paid</option>
          <option value="failed" {% if o.payment_status=='failed' %}selected{% endif %}>failed</option>
        </select>
        <input name="estimated_delivery_date" value="{{ o.estimated_delivery_date or '' }}" placeholder="YYYY-MM-DD">
        <button>Update</button>
      </form>
    </td>
  </tr>
  {% endfor %}
</table>
{% endblock %}
